---
layout: post
title: 코루틴 변수 저장
categories: devlog
comments: true
description: >
 C#, Unity에서 코루틴을 사용할 때 변수에 저장해서 사용하는 2가지 방법을 알아본다.
noindex: true
---

코루틴을 변수로 저장하고 싶을 때가 있다. 하나의 코루틴 함수를 여러 곳에서 호출하거나, 코루틴을 멈추고 싶을 때 주로 변수로 저장하여 호출하곤 한다.

## 코루틴의 문제점

코루틴을 시작할때(StartCoroutine) 함수를 호출하는 방식은 2가지 있다 하지만 특정 방식으로 호출을 하면 코루틴을 멈추고 싶을 때(StopCoroutine) 명령어가 제대로 작동하지 않는다.

```c#
    IEnumerator CoroutineMethod()
    {
    	// to do...
    	while(true)
    	{
    		print("Hi");
    		yield return null;
    	}
    }
    
    // - string값으로 코루틴 시작
    StartCoroutine("CoroutineMethod");
    StopCoroutine("CoroutineMethod"); // 멈출 수 있다
    
    // - 함수호출로 코루틴 시작
    StartCoroutin(CoroutineMethod());
    StopCoroutine(CoroutineMethod()); // 멈출 수 없다
    StopCoroutine("CoroutineMethod"); // 멈출 수 없다
```

위처럼 함수호출로 코루틴을 시작하는 경우 멈출 수 없는 문제가 있다.

그럼 계속 string값으로 불러온다면 되지 않냐고 생각할 수도 있다. 하지만 Ctrl+F12 등을 이용하여 어디서 이 함수를 호출했는지 모아서 보고 싶은 경우 아주 귀찮아진다. 무엇보다 파라메터를 전달해야 할 때 문제가 생긴다. 

```c#
    IEnumerator CoroutineMethod(GameObject obj)
    {
    	// to do...
    	while(true)
    	{
    		obj.transform.position += Vector3.Right * 0.3f * Time.deltaTime;
    		yield return null;
    	}
    }
    
    // - 함수호출로 코루틴 시작
    StartCoroutin(CoroutineMethod(wantedObj));
    StopCoroutine(CoroutineMethod(wantedObj)); // 멈출 수 없다
```

이럴 때 코루틴을 변수로 저장하여 사용하게 된다.

## 코루틴을 변수로 저장

변수로 저장하는 방법도 2가지가 있다. 하나는 코루틴 자체를 저장하는 방법, 그리고 또 하나는 IEnumerable 인터페이스 자체를 저장하는 방법이다.

### Coroutine 저장

```c#
    IEnumerator CoroutineMethod(GameObject obj)
    {
    	// to do...
    	while(true)
    	{
    		obj.transform.position += Vector3.Right * 0.3f * Time.deltaTime;
    		yield return null;
    	}
    }
    
    // 변수선언
    Coroutine co = null;
    
     // 호출할 때 변수에 저장
     co = StartCoroutine (CoroutineMethod(wantedObj));
     // 중단
     StopCoroutine(co);
```

### IEnumerable 저장

```c#
    IEnumerator CoroutineMethod(GameObject obj)
    {
    	// to do...
    	while(true)
    	{
    		obj.transform.position += Vector3.Right * 0.3f * Time.deltaTime;
    		yield return null;
    	}
    }
    
    // 변수선언
    IEnumerator ie = null;
     
    // 변수에 저장
    ie  = CoroutineMethod (twantedObj);
    // 호출
    StartCoroutine(ie);
    // 중단
    StopCoroutine(ie);
```
