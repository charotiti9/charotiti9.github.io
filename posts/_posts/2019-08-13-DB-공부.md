---
layout: post
title: DB 공부
categories: devlog
comments: true
description: >
 친구들과 간단하게 DB에 대해서 공부한 내용 정리
noindex: true
---

# DB와 서버

## 기본
 - 클라이언트: 그래픽이나 정보가 그려지는 껍데기
	 - 서버에서 전달받은 것을 바탕으로 그래픽 요소를 그리거나 애니메이션을 재생
 - DB:  플레이어 정보를 가지고 있다. (ID/PW/IP...)
 - 서버:  정보 전달

### DB는 왜 만들까?
서버에서 가지고있지 않고 왜 DB를 쓸까?
1. 무결성 검사를 해준다
2. 검색이 용이

조건들은 서버가 검사한다.
why? 보안상! 클라이언트는 로컬pc에 존재하기 때문에 변경하기 쉽다.
따라서 서버가 조건을 검사후 가능하다면 클라이언트에게 가능하다고 알려줘서 처리한다.

### 채팅시스템
 1. 서버가 구동중
 2. A가 로그인 버튼 클릭
 3. A의 ID와 PW 정보를 클라이언트가 서버에게 전달
 4. 서버는 ID와 PW를 DB와 비교
 5. 맞다면 DB의 접속자 명단에 추가.
 6. 서버는 DB에서 A를 접속하고 있는 사람 정보로 테이블을 옮긴다.
 7. 그리고 DB는 접속하고 있는 사람 정보를 서버에게 전달
 8. 서버는 "A가 로그인을 했습니다"라는 문구를 DB에서 받은 사람들에게 띄워준다.

## 데이터를 주고받을 때의 약속

### 랜뽑
A가 랜선을 뽑아버렸다?
접속자 명단에 남아있는 A.
서버가 눈치채는 순간은? A가 정보를 전달받았다는 답이 안 올 경우!

### 3way 핸드셰이킹(3단계로 이루어진 악수)
A가 B에게 '연결하고 싶어'
B가 잘 받았다면 '그래 연결할게'
A가 또 잘 받았다면 '어 연결됐어'

### 연결을 시작할 때 오류 발생한다면
A가 보냈는데 B가 응답이 없는경우
A가 할 일
1. 타임을 기다린다. 30분이 지나도 안오면 다시 한 번 보낸다. 동시다발적으로 일어나야하는 경우(기다릴 시간이 없는경우) 0.x초로 시간을 줄일 수도 있다.
2. 안기다리고 손절 (연결이 실패했습니다)

### 데이터를 보내는 방식
정보를 보낼 때 2진수로 보내는데, 엄청 긴 블럭으로 보낸다. (형식이 정해져있음)

네트워크 상에는 TCP/IP라는 규칙이 있음.
IP주소가 들어가야한다. 받을 주소도 들어가야한다. 텍스트. 네트워킹 설정... 등등의 모음의 집합을 패킷이라 하고
패킷을 보내는 규약이 TCP/IP이다.

A노드와 B노드 사이에 많은 것들이 있는데 이들을 라우터라 한다.
이들을 통해서 정보가 발송된다

## DB
DB에는 테이블이란 것이 있다
맨 위에는 속성(column)이 들어가고 그것만 일단 설정해주면 된다
ID를 기본키로 설정한다.

### Key
유니크키: 속성이 모두 달라야함. 한 테이블에 여러개 설정이 가능합니다. 기본키는 유니크키에 포함되어있다.
기본키: 하나의 속성만이 아니라 두 세개씩 묶어서 설정할 수 있다(ex.동명이인인데 나이가 다름)
외래키: 테이블이 하나가 아니라 두 세개가 있을 때, 다른 테이블에 같은 데이터 속성이 있으면 같은 속성끼리 연결해주는 것을 외래키라고 한다. 단방향으로만 연결된다.

### Select 문
내가 원하는 것만 선택해서 정보를 가져오는 명령어
1. 어떤 테이블을 검색할 것인가?
2. 어떤 속성을 검색할 것인가?
3. 어떤 조건으로 설정할 것인가?

### 조인
셀렉트 문에서 외래키를 사용하려면 테이블 선택에서 사용할 테이블 모두를 입력해두어야한다.
외래키 연결이 되어 있지 않은 테이블 2개에서 검색하면 중복으로 검색될 수 있다.
외래키를 사용한 검색을 '조인'이라고 부른다(명령어는 아님)

