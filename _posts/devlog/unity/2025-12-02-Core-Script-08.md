---
layout: post
title: ê³µìš© ìŠ¤í¬ë¦½íŠ¸ ì œì‘ê¸°ğŸˆ - ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œ í¸
category: devlog
tags: [unity, CoreScript, Retrospective]
image: /assets/img/blog/unity/2025/CoreBanner08.png
description: >
  Unity í”„ë¡œì íŠ¸ì˜ ê³µìš©ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì œì‘í•˜ë©´ì„œ ì–´ë–»ê²Œ ë§Œë“¤ì—ˆëŠ”ì§€, ì–´ë–¤ ì ì— ì‹ ê²½ì¼ëŠ”ì§€ ì„¤ëª…í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.
comments: true
---

* this unordered seed list will be replaced by toc as unordered list
{:toc}

ê²Œì„ ë§Œë“œëŠ”ë° í•­ìƒ í•„ìš”í•œ ê²ƒ, ê·¸ê²ƒì€ ë°”ë¡œ ì˜¤ë””ì˜¤ ì‹œìŠ¤í…œì´ë‹¤. ê·¸ëŸ¬ë‚˜ ê°€ì¥ ë§Œë“¤ê¸° ê·€ì°®ì€ ê²ƒì´ê¸°ë„ í•˜ë‹¤. BGM, SFX ë“± ê°ê° ë”°ë¡œ ê´€ë¦¬í•˜ê³ , ë³¼ë¥¨ ì¡°ì ˆë„ í•´ì•¼í•˜ê³ , ë©”ëª¨ë¦¬ ê´€ë¦¬ë„ ì‹ ê²½ ì¨ì•¼ í•˜ê³ , í˜ì´ë“œ íš¨ê³¼ë„ ë„£ìœ¼ë©´ ì¢‹ë‹¤. ì´ë¥¼ í†µí•© ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” Audio ì‹œìŠ¤í…œì„ ë§Œë“¤ê¸°ë¡œ í–ˆë‹¤.

ì±„ë„ ê¸°ë°˜ìœ¼ë¡œ ì˜¤ë””ì˜¤ë¥¼ ë¶„ë¥˜í•˜ê³ , Addressableê³¼ í’€ë§ì„ í™œìš©í•´ ë©”ëª¨ë¦¬ë¥¼ ìµœì í™”í•˜ë©°, í˜ì´ë“œ/í¬ë¡œìŠ¤í˜ì´ë“œ ê°™ì€ íš¨ê³¼ê¹Œì§€ ë‚´ì¥ëœ ì‹œìŠ¤í…œì„ ë§Œë“¤ì. ê·¸ë¦¬ê³  ì‚¬ìš©ì€ AudioManagerë¥¼ APIì²˜ëŸ¼ ì‚¬ìš©í•˜ì—¬ í•˜ë‚˜ë¡œ í•´ê²°í•˜ì.

# ğŸ’¡ì˜ˆì‹œ
ê°„ë‹¨í•˜ê²Œ ë¨¼ì € ì‚¬ìš© ì˜ˆì‹œë¶€í„° ì†Œê°œí•´ë³´ìë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

```cs
// BGM ì¬ìƒ (í˜ì´ë“œ ì¸)
await AudioManager.Instance.PlayBGMAsync("Audio/BGM/Title", fadeInDuration: 2f, ct);

// BGM í¬ë¡œìŠ¤í˜ì´ë“œ ì „í™˜
await AudioManager.Instance.CrossFadeBGMAsync("Audio/BGM/Battle", duration: 3f, ct);

// SFX ì¬ìƒ (2D)
await AudioManager.Instance.PlaySFXAsync("Audio/SFX/ButtonClick", volume: 0.8f, ct);

// SFX ì¬ìƒ (3D ìœ„ì¹˜)
await AudioManager.Instance.PlaySFXAtPositionAsync(
    "Audio/SFX/Explosion",
    enemyPosition,
    volume: 1f,
    ct
);

// Voice ì¬ìƒ ë° ì™„ë£Œ ëŒ€ê¸°
await AudioManager.Instance.PlayVoiceAsync("Audio/Voice/Intro", ct);
var reason = await AudioManager.Instance.WaitForVoiceCompleteAsync(ct);
if (reason == VoiceCompleteReason.Skipped)
{
    Debug.Log("Voice was skipped");
}

// ë³¼ë¥¨ ì¡°ì ˆ
AudioManager.Instance.MasterVolume = 0.8f;
AudioManager.Instance.BGMVolume = 0.6f;
AudioManager.Instance.SFXVolume = 1.0f;

// ìŒì†Œê±°
AudioManager.Instance.IsBGMMuted = true;

// í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ì‚¬ìš©
var playlist = AudioManager.Instance.CreatePlaylist(
    new List<string> { "BGM1", "BGM2", "BGM3" },
    AudioPlaylist.PlayMode.Shuffle
);
await playlist.PlayNextBGMAsync(crossFadeDuration: 2f, ct);
```

# ğŸ“Š í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```
AudioManager (ì‹±ê¸€í†¤)
â”œâ”€ AudioChannel (BGM, Voice, SFX)
â””â”€ AudioVolume (ë³¼ë¥¨/ìŒì†Œê±° ê´€ë¦¬)

AudioSoundBase (ì¶”ìƒ í´ë˜ìŠ¤)
â”œâ”€ BGMSound: ë“€ì–¼ AudioSourceë¡œ í¬ë¡œìŠ¤í˜ì´ë“œ
â”œâ”€ SFXSound: IPoolable, ìë™ í’€ ë°˜í™˜
â””â”€ VoiceSound: ìŠ¤í‚µ ê¸°ëŠ¥, ì™„ë£Œ ê°ì§€

Extensions (í™•ì¥ ê¸°ëŠ¥)
â”œâ”€ AudioPlaylist: ìˆœì°¨/ëœë¤/ì…”í”Œ ì¬ìƒ
â”œâ”€ AudioFader: í˜ì´ë“œ ì¸/ì•„ì›ƒ, í¬ë¡œìŠ¤í˜ì´ë“œ
â””â”€ UIButtonSound: UI ë²„íŠ¼ í´ë¦­ ì‚¬ìš´ë“œ ìë™ ì¬ìƒ
```

# ğŸ“ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
## í•µì‹¬ ì»´í¬ë„ŒíŠ¸

###### AudioManager (ì‹±ê¸€í†¤ ë§¤ë‹ˆì €)
- ì—­í• : ëª¨ë“  ì˜¤ë””ì˜¤ì˜ ì§„ì…ì ì´ì ì¤‘ì•™ ê´€ë¦¬ì
- ì£¼ìš” ê¸°ëŠ¥:
  - 3ê°œ ì±„ë„ ê´€ë¦¬ (BGM, SFX, Voice)
  - Addressable ê¸°ë°˜ AudioClip ë¡œë“œ
  - ë³¼ë¥¨ ë° ìŒì†Œê±° í†µí•© ì œì–´
  - GameFlowì— ë“±ë¡ë˜ì–´ ë§¤ í”„ë ˆì„ ì±„ë„ ì—…ë°ì´íŠ¸
  - í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ìƒì„±
- ì´ˆê¸°í™”:
  - `Initialize()`ì—ì„œ ë¹„ë™ê¸°ë¡œ Config ë¡œë“œ ë° ì±„ë„ ìƒì„±
  - BGMSound, VoiceSoundëŠ” ëŸ°íƒ€ì„ì— GameObjectë¡œ ìƒì„±
  - SFXSoundëŠ” í’€ë§ìœ¼ë¡œ ê´€ë¦¬

###### AudioChannel / SFXChannel
- ì—­í• : ì±„ë„ë³„ ë³¼ë¥¨, ìŒì†Œê±° ê´€ë¦¬
- AudioChannel íŠ¹ì§•:
  - BGM, Voice ì±„ë„ì— ì‚¬ìš©
  - í•œ ë²ˆì— í•˜ë‚˜ë§Œ ì¬ìƒ
  - ë³¼ë¥¨ ê³„ì‚°: `MasterVolume * ChannelVolume * LocalVolume`
  - volumeDirty í”Œë˜ê·¸ë¡œ ë³€ê²½ ê°ì§€
- SFXChannel íŠ¹ì§• (ì¶”ì •):
  - AudioChannel ìƒì†
  - ë™ì‹œ ì¬ìƒ ì œí•œ (maxConcurrentSFX)
  - í’€ë§ ê¸°ë°˜ SFXSound ê´€ë¦¬
  - ìš°ì„ ìˆœìœ„ ì‹œìŠ¤í…œ ì§€ì›

###### AudioSoundBase (ì¶”ìƒ í´ë˜ìŠ¤)
- ì—­í• : ëª¨ë“  ì‚¬ìš´ë“œì˜ ê¸°ë³¸ í´ë˜ìŠ¤
- ê³µí†µ ê¸°ëŠ¥:
  - AudioSource ê´€ë¦¬
  - CurrentAddress ì¶”ì  (Addressable í•´ì œìš©)
  - IsPlaying ìƒíƒœ ê´€ë¦¬
  - ReleaseCurrentAddress() ìë™ ì •ë¦¬

###### BGMSound
- ì—­í• : BGM ì „ìš© ì‚¬ìš´ë“œ (ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤)
- íŠ¹ì§•:
  - PlayAsync: í˜ì´ë“œ ì¸ ì§€ì›
  - StopAsync: í˜ì´ë“œ ì•„ì›ƒ ì§€ì›
  - CrossFadeAsync: ë‘ AudioSourceë¥¼ í•‘íí•˜ë©° ì „í™˜
  - Pause/Resume ì§€ì›
  - CancellationTokenSourceë¡œ í˜ì´ë“œ ì¤‘ë‹¨ ê°€ëŠ¥

###### SFXSound
- ì—­í• : SFX ì „ìš© ì‚¬ìš´ë“œ (í’€ë§)
- íŠ¹ì§•:
  - IPoolable êµ¬í˜„
  - ì¬ìƒ ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ í’€ì— ë°˜í™˜
  - AudioSourceëŠ” Prefabì— ë¯¸ë¦¬ í¬í•¨
  - UniTaskCompletionSourceë¡œ ì¬ìƒ ì™„ë£Œ ê°ì§€
  - OnReturnToPoolì—ì„œ Addressable í•´ì œ

###### VoiceSound
- ì—­í• : Voice/ëŒ€ì‚¬ ì „ìš© ì‚¬ìš´ë“œ (ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤)
- íŠ¹ì§•:
  - Skip ê¸°ëŠ¥ (í”Œë ˆì´ì–´ ì…ë ¥)
  - WaitForCompleteAsyncë¡œ ì™„ë£Œ ëŒ€ê¸°
  - VoiceCompleteReason ë°˜í™˜ (Completed/Skipped/Cancelled)
  - MonitorPlaybackAsyncë¡œ ì¬ìƒ ìƒíƒœ ì¶”ì 

###### AudioVolume
- ì—­í• : ë³¼ë¥¨ ë° ìŒì†Œê±° ê´€ë¦¬ (ë‹¨ì¼ ì±…ì„ ì›ì¹™)
- ì£¼ìš” ê¸°ëŠ¥:
  - Master, BGM, SFX, Voice ë³¼ë¥¨ ê´€ë¦¬
  - ê° ì±„ë„ ìŒì†Œê±° ë…ë¦½ ì œì–´
  - AudioSettingsë¡œ PlayerPrefsì— ì €ì¥/ë¡œë“œ
  - ë³¼ë¥¨ ë³€ê²½ ì‹œ ì±„ë„ì— MarkVolumeDirty() í˜¸ì¶œ
  - ResetSettingsë¡œ ê¸°ë³¸ê°’ ë³µì›

###### AudioFader
- ì—­í• : í˜ì´ë“œ íš¨ê³¼ ì „ë‹´
- ì£¼ìš” ê¸°ëŠ¥:
  - FadeInAsync: 0 â†’ targetVolume
  - FadeOutAsync: currentVolume â†’ 0
  - CrossFadeAsync: ë‘ AudioSource ë™ì‹œ í˜ì´ë“œ (UniTask.WhenAll)
  - CancellationToken ì§€ì›
  - deltaTime ê¸°ë°˜ ë¶€ë“œëŸ¬ìš´ ë³´ê°„

###### AudioPlaylist
- ì—­í• : í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬
- PlayMode:
  - Sequential: ìˆœì°¨ ì¬ìƒ
  - Random: ì™„ì „ ëœë¤
  - Shuffle: ì „ì²´ ì¬ìƒ í›„ ë‹¤ì‹œ ì…”í”Œ (ì¤‘ë³µ ë°©ì§€)
- ì£¼ìš” ê¸°ëŠ¥:
  - BGM í”Œë ˆì´ë¦¬ìŠ¤íŠ¸: PlayNextBGMAsync, PlayPreviousBGMAsync
  - SFX í”Œë ˆì´ë¦¬ìŠ¤íŠ¸: PlaySFXAsync
  - AddAddress, RemoveAddressë¡œ ë™ì  ê´€ë¦¬
  - Fisher-Yates ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì…”í”Œ

# ğŸ”„ ë°ì´í„° íë¦„

###### ì´ˆê¸°í™” ë‹¨ê³„
1. AudioManager.Initialize() í˜¸ì¶œ (ê²Œì„ ì‹œì‘ ì‹œ)  
   â†“
2. InitializeAsync ì‹¤í–‰:
   - AudioConfig ë¡œë“œ (Addressable)
   - 3ê°œ ì±„ë„ ìƒì„± (BGM, SFX, Voice)
   - BGMSound, VoiceSound GameObject ìƒì„±
   - AudioVolumeManager ì´ˆê¸°í™”
   - ì„¤ì • ë¡œë“œ (PlayerPrefs)  
   â†“
1. GameFlowManagerì— IUpdatable ë“±ë¡  
   â†“
2. \[ì™„ë£Œ] AudioManager ì‚¬ìš© ê°€ëŠ¥

###### BGM ì¬ìƒ í”„ë¡œì„¸ìŠ¤
1. PlayBGMAsync í˜¸ì¶œ  
   â†“
2. \[ì¤‘ë³µ ì²´í¬] ê°™ì€ BGMì´ ì¬ìƒ ì¤‘ì´ë©´ ë¬´ì‹œ
3. \[í˜ì´ë“œ ì•„ì›ƒ] í˜„ì¬ BGM ì •ì§€ (fadeInDuration)  
   â†“
4. \[Addressable] ìƒˆ AudioClip ë¡œë“œ
5. \[ë³¼ë¥¨ ê³„ì‚°] `bgmChannel.GetFinalVolume(BGMVolume)`  
   â†“
6. \[BGMSound] PlayAsync í˜¸ì¶œ:
   - AudioSource.clip ì„¤ì •
   - volume = 0 (í˜ì´ë“œìš©)
   - AudioSource.Play()
   - AudioFader.FadeInAsync (0 â†’ targetVolume)  
   â†“
7. \[ì™„ë£Œ] BGM ì¬ìƒ ì¤‘

###### SFX ì¬ìƒ í”„ë¡œì„¸ìŠ¤
1. PlaySFXAsync í˜¸ì¶œ  
   â†“
2. \[SFXChannel] Play2DAsync ì‹¤í–‰:
   - ë™ì‹œ ì¬ìƒ ìˆ˜ ì²´í¬ (maxConcurrentSFX)
   - ìš°ì„ ìˆœìœ„ ë¹„êµ (ë‚®ìœ¼ë©´ ê±°ë¶€)  
   â†“
3. \[PoolManager] SFXSound íšë“ (ì—†ìœ¼ë©´ ìƒì„±)
4. \[Addressable] AudioClip ë¡œë“œ  
   â†“
5. \[SFXSound] Play ì‹¤í–‰:
   - AudioSource.clip ì„¤ì •
   - AudioSource.Play()
   - completionSource ìƒì„±  
   â†“
6. \[Update Loop] ì¬ìƒ ì™„ë£Œ ê°ì§€
7. \[ìë™ ë°˜í™˜] OnPlayComplete â†’ í’€ì— ë°˜í™˜  
   â†“
8. \[ì™„ë£Œ] SFX ì¬ìƒ ì™„ë£Œ

###### Voice ì¬ìƒ í”„ë¡œì„¸ìŠ¤
1. PlayVoiceAsync í˜¸ì¶œ  
   â†“
2. \[Addressable] AudioClip ë¡œë“œ
3. \[VoiceSound] PlayAsync í˜¸ì¶œ:
   - AudioSource.clip ì„¤ì •
   - AudioSource.Play()
   - MonitorPlaybackAsync ì‹œì‘  
   â†“
4. \[ëŒ€ê¸°] WaitForVoiceCompleteAsyncë¡œ ì™„ë£Œ ëŒ€ê¸°
5. \[ëª¨ë‹ˆí„°ë§] MonitorPlaybackAsync:
   - AudioSource.isPlaying ì²´í¬
   - ì™„ë£Œ ì‹œ completionSource.TrySetResult()  
   â†“
6. \[ìŠ¤í‚µ ê°ì§€] Skip() í˜¸ì¶œ ì‹œ VoiceCompleteReason.Skipped ë°˜í™˜
7. \[ì •ë¦¬] ReleaseCurrentAddress()  
   â†“
8. \[ì™„ë£Œ] Voice ì¬ìƒ ì™„ë£Œ

# ğŸ¯ ì‹ ê²½ ì“´ ë¶€ë¶„

###### 3ì±„ë„ ì‹œìŠ¤í…œ
ì˜¤ë””ì˜¤ë¥¼ BGM, SFX, Voiceë¡œ ëª…í™•í•˜ê²Œ ë¶„ë¦¬
- BGM: ê²Œì„ ë°°ê²½ìŒì•…, í¬ë¡œìŠ¤í˜ì´ë“œ ì „í™˜
- SFX: íš¨ê³¼ìŒ, ë™ì‹œ ì¬ìƒ, í’€ë§
- Voice: ìŒì„±/ëŒ€ì‚¬, ìŠ¤í‚µ ê¸°ëŠ¥

ì´ë ‡ê²Œ ë¶„ë¦¬í•˜ë©´ ë³¼ë¥¨ ì¡°ì ˆì´ ì§ê´€ì ì´ê³ , ê° ì±„ë„ì— íŠ¹í™”ëœ ê¸°ëŠ¥ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤.

###### Addressable í†µí•©
ëª¨ë“  AudioClipì„ Addressableë¡œ ë¡œë“œ
- ë©”ëª¨ë¦¬ íš¨ìœ¨: í•„ìš”í•  ë•Œë§Œ ë¡œë“œ, ìë™ ì–¸ë¡œë“œ
- ReleaseCurrentAddress()ë¡œ ì•ˆì „í•œ í•´ì œ
- ì—ëŸ¬ ì²˜ë¦¬: finally ë¸”ë¡ì—ì„œ clipLoaded í”Œë˜ê·¸ í™•ì¸
```cs
bool clipLoaded = false;
try
{
    clip = await AddressableLoader.Instance.LoadAssetAsync<AudioClip>(address, ct);
    clipLoaded = true;
    await bgmSound.PlayAsync(address, clip, volume, fadeInDuration, ct);
    clipLoaded = false;  // ì„±ê³µ ì‹œ ì±…ì„ ì´ì „
}
finally
{
    // ë¡œë“œëŠ” ì„±ê³µí–ˆì§€ë§Œ PlayAsyncì—ì„œ ì‹¤íŒ¨í•œ ê²½ìš°ì—ë§Œ Release
    if (clipLoaded)
    {
        AddressableLoader.Instance.Release(address);
    }
}
```

###### SFX í’€ë§ ì‹œìŠ¤í…œ
SFXSoundë¥¼ ì˜¤ë¸Œì íŠ¸ í’€ë¡œ ê´€ë¦¬í•˜ì—¬ GC ë°©ì§€
- IPoolable êµ¬í˜„: OnGetFromPool, OnReturnToPool
- ìë™ ë°˜í™˜: ì¬ìƒ ì™„ë£Œ ì‹œ í’€ì— ë°˜í™˜
- ë™ì‹œ ì¬ìƒ ì œí•œ: maxConcurrentSFX
- ìš°ì„ ìˆœìœ„: priorityê°€ ë‚®ìœ¼ë©´ ì¬ìƒ ê±°ë¶€

# ê²°ë¡ 
ìƒê°ë³´ë‹¤ í•  ê²Œ ì—¬ëŸ¬ê°€ì§€ ë– ì˜¬ë¼ì„œ ê¸°ëŠ¥ì„ ë§ì´ ë„£ì—ˆë‹¤. ê·¼ë°ë„ ë­”ê°€ ëœ ë„£ì€ ê¸°ë¶„ì´ ë“œëŠ” ê±´ ì™¤ê¹Œ. í•˜ì§€ë§Œ ë”ì´ìƒ ìƒê°ì´ ì•ˆë‚œë‹¤.