---
layout: post
title: ê³µìš© ìŠ¤í¬ë¦½íŠ¸ ì œì‘ê¸°ğŸˆ - ì‹±ê¸€í†¤ í¸
category: devlog
tags: [unity, CoreScript, Retrospective]
image: /assets/img/blog/unity/2025/CoreBanner01.png
description: >
  Unity í”„ë¡œì íŠ¸ì˜ ê³µìš©ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì œì‘í•˜ë©´ì„œ ì–´ë–»ê²Œ ë§Œë“¤ì—ˆëŠ”ì§€, ì–´ë–¤ ì ì— ì‹ ê²½ì¼ëŠ”ì§€ ì„¤ëª…í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.
comments: true
---

Singleton í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì•„ì„œ Manager í´ë˜ìŠ¤ë¥¼ ì‹±ê¸€í†¤ìœ¼ë¡œ ë§Œë“œëŠ” ê±´ ì´ë¯¸ í”í•œ ê¸°ë²•ì´ë‹¤. ì´ë¥¼ ë§¤ë²ˆ ìƒˆë¡œ ë§Œë“¤ì–´ì“°ìë‹ˆ ì—­ì‹œ ê·€ì°®ì•„ì„œ, ì´ ì°¸ì— ë‹¨ë‹¨í•˜ê²Œ í•œ ë²ˆ ë‹¤ì§€ê³  ì§€ë‚˜ê°€ë³´ë ¤ í•œë‹¤. ì´ ê¸€ì—ì„œ ë”°ë¡œ ì‹±ê¸€í†¤ íŒ¨í„´ì´ ì–´ë– ë‹ˆ ì €ì©Œë‹ˆ ë– ë“¤ì§€ëŠ” ì•Šê² ë‹¤. ê°„ë‹¨í•˜ê²Œ ì™œ ì´ë ‡ê²Œ ë§Œë“¤ì—ˆëŠ”ì§€ë¥¼ ì •ë¦¬í•´ë†“ìœ¼ë ¤ í•œë‹¤.

* this unordered seed list will be replaced by toc as unordered list
{:toc}

# ë¶„ë¥˜í•˜ê¸°
**í¬ê²Œ ë‘ ì¢…ë¥˜ë¥¼ ê°œë°œí•˜ë ¤ í•œë‹¤.**
1. ì¼ë°˜ C# Singleton
2. MonoBehaviourë¥¼ ìƒì†ë°›ëŠ” Singleton

###### C# Singleton íŠ¹ì§•
- Unityì˜ ìƒëª…ì£¼ê¸°ì™€ ë…ë¦½ì ìœ¼ë¡œ ë™ì‘
- ë°ì´í„°ë¥¼ ê´€ë¦¬í•  ë•Œ í˜¹ì€ ìˆœìˆ˜ ë¡œì§ë§Œ ë‹´ë‹¹í•˜ëŠ” ì‹œìŠ¤í…œì— ì í•©

###### MonoBehaviour Singleton íŠ¹ì§•
- GameObjectì— ì»´í¬ë„ŒíŠ¸ë¡œ ë¶€ì°©ë¨
- Unityì˜ ìƒëª…ì£¼ê¸° ë©”ì„œë“œ ì‚¬ìš©ê°€ëŠ¥
- Sceneê´€ë¦¬ê°€ í•„ìš”í•œ ì‹œìŠ¤í…œ í˜¹ì€ Unityì˜ ì‹œìŠ¤í…œì´ í•„ìš”í•œ ê²½ìš°ì— ì‚¬ìš©

**ê·¸ë¦¬ê³  ê°ê°ì€ ë˜ EagerSingletonê³¼ LazySingleton ë‘ ê°€ì§€ë¡œ ë‚˜ë‰œë‹¤.** 

###### EagerSingleton íŠ¹ì§•
- íƒ€ì… ë¡œë“œ ì‹œì— ì¸ìŠ¤í„´ìŠ¤ ì¦‰ì‹œ ìƒì„±
- lockì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ë˜ì–´ ì„±ëŠ¥ì´ ìš°ìˆ˜í•¨
- ê²Œì„ ì „ì²´ì—ì„œ ì‚¬ìš©ë˜ëŠ” í•µì‹¬ ë§¤ë‹ˆì €ì— ì í•©

###### LazySingleton íŠ¹ì§•
- ì‹¤ì œë¡œ í•„ìš”í•  ë•Œê¹Œì§€ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ì„ ë¯¸ë£¸
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì 
- ê²Œì„ ì „ì²´ì—ì„œ ì‚¬ìš©ë˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆëŠ” ì‹œìŠ¤í…œ ë° ì´ˆê¸°í™” ë¹„ìš©ì´ í´ ë•Œ ì í•©

## ë¶„ë¥˜ ì´ìœ 
ì„±ëŠ¥ì˜ ìµœì í™”ë¥¼ ìœ„í•´ì„œ ì´ë ‡ê²Œ ì„¸ë¶„í™” í•˜ì˜€ë‹¤. ìˆœìˆ˜ C# ì‹±ê¸€í†¤ì€ MonoBehaviourì˜ ì˜¤ë²„í—¤ë“œ ì—†ì´ ê°€ë³ê²Œ ë™ì‘í•  ìˆ˜ ìˆê³ , ë©”ëª¨ë¦¬ë¥¼ ìµœì í™” í•˜ê¸° ìœ„í•´ Lazyë¼ëŠ” ì„ íƒì§€ë¥¼ ë‘ì—ˆë‹¤.
ë˜í•œ ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ ëª…í™•í•˜ê²Œ ì±…ì„ ë¶„ë¦¬ê°€ ëœë‹¤.

# ì£¼ì˜ì‚¬í•­
- MonoBehaviourë¥¼ ìƒì†ë°›ëŠ” ê°œì²´ëŠ” `DontDestroyOnLoad`ê°€ ì—†ìœ¼ë©´ ì”¬ì´ ì „í™˜ë  ë•Œ íŒŒê´´ëœë‹¤. ë•Œë¬¸ì— `IsPersistence` ë“±ì˜ `bool`ê°’ì„ ì‚¬ìš©í•˜ì—¬ ì”¬ ì „í™˜ ì‹œ íŒŒê´´ê°€ ë˜ì§€ ì•ŠëŠ” ì˜µì…˜ë„ ì œê³µí•  ì˜ˆì •ì´ë‹¤
- ë°˜ë©´ ìˆœìˆ˜ C# Singletonì€ ì”¬ê³¼ ë¬´ê´€í•˜ê²Œ ê³„ì† ë©”ëª¨ë¦¬ì— ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ ë©”ëª¨ë¦¬ ê´€ë¦¬ì— ì£¼ì˜ê°€ í•„ìš”í•˜ë‹¤
- EagerMonoSingletonëŠ” ì”¬ì— ë°˜ë“œì‹œ ë¯¸ë¦¬ ë°°ì¹˜ë˜ì–´ì•¼ í•œë‹¤ (ëŸ°íƒ€ì„ì— ìë™ ìƒì„± ë¶ˆê°€)
- LazyMonoSingletonì€ ì”¬ì— ë°°ì¹˜ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ìë™ìœ¼ë¡œ ìƒì„±í•œë‹¤

# ì‹¤ì œ êµ¬í˜„
###### C# Singleton - Eager
```cs
public abstract class EagerSingleton<T> where T : class, new()
{
    private static readonly T _instance;

    /// <summary>
    /// ì •ì  ìƒì„±ìëŠ” CLRì´ íƒ€ì… ìµœì´ˆ ì ‘ê·¼ ì‹œ ë‹¨ í•œ ë²ˆë§Œ ì‹¤í–‰í•¨ì„ ë³´ì¥ (ë‚´ë¶€ì ìœ¼ë¡œ lock ì‚¬ìš©)
    /// = ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œë„ lock ì—†ì´ ì•ˆì „
    /// </summary>
    static EagerSingleton()
    {
        _instance = new T();
        (_instance as EagerSingleton<T>)?.Initialize();
    }

    public static T Instance => _instance;

    /// <summary>
    /// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
    /// Eager ì‹±ê¸€í†¤ì€ íƒ€ì… ë¡œë“œ ì‹œ ì¦‰ì‹œ ìƒì„±ë˜ë¯€ë¡œ í•­ìƒ true
    /// </summary>
    /// <returns>í•­ìƒ true</returns>
    public static bool IsAlive() => _instance != null;

    /// <summary>
    /// íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì§ì ‘ ìƒì„±í•˜ì§€ ëª»í•˜ë„ë¡ protected
    /// </summary>
    protected EagerSingleton()
    {
    }

    /// <summary>
    /// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™”
    /// íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ì´ˆê¸°í™” ë¡œì§ êµ¬í˜„
    /// </summary>
    protected virtual void Initialize()
    {
    }

    // Eager ì‹±ê¸€í†¤ì€ í•œë²ˆ ìƒì„±ë˜ë©´ í•´ì œí•  ìˆ˜ ì—†ìŒ
}
```

###### C# Singleton - Lazy
```cs
public abstract class LazySingleton<T> where T : class, new()
{
    private static T _instance;
    private static readonly object _lock = new object();

    public static T Instance
    {
        get
        {
            // lock ê±´ ì´í›„ì—ë„ _instanceê°€ ìƒì„±ë˜ì—ˆì„ ìˆ˜ë„ ìˆìœ¼ë‹ˆ
            // Double-checked locking íŒ¨í„´ìœ¼ë¡œ ìŠ¤ë ˆë“œ ì„¸ì´í”„ ë³´ì¥
            if (_instance == null)
            {
                lock (_lock)
                {
                    // ì´ˆê¸°í™” ë©”ì„œë“œ í˜¸ì¶œ
                    if (_instance == null)
                    {
                        _instance = new T();
                        (_instance as LazySingleton<T>)?.Initialize();
                    }
                }
            }

            return _instance;
        }
    }

    /// <summary>
    /// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
    /// </summary>
    /// <returns>ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ë©´ true, ì•„ë‹ˆë©´ false</returns>
    public static bool IsAlive() => _instance != null;

    /// <summary>
    /// íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì§ì ‘ ìƒì„±í•˜ì§€ ëª»í•˜ë„ë¡ protected
    /// </summary>
    protected LazySingleton()
    {
    }

    /// <summary>
    /// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™”
    /// íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ì´ˆê¸°í™” ë¡œì§ êµ¬í˜„
    /// </summary>
    protected virtual void Initialize()
    {
    }

    /// <summary>
    /// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ í•´ì œ
    /// ì£¼ë¡œ í…ŒìŠ¤íŠ¸ë‚˜ ì”¬ ì „í™˜ ì‹œ ì‚¬ìš©
    /// </summary>
    public static void DestroyInstance()
    {
        lock (_lock)
        {
            _instance = null;
        }
    }
}
```

###### MonoBehaviour Singleton - Eager
```cs
public abstract class EagerMonoSingleton<T> : MonoBehaviour where T : MonoBehaviour
{
    private static T _instance;
    private static bool isInitialized = false;
    private static bool isApplicationQuitting = false;

    public static T Instance
    {
        get
        {
            // ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì¤‘ì—ëŠ” null ë°˜í™˜
            if (isApplicationQuitting)
            {
                return null;
            }

            // Awake ì „ ì ‘ê·¼ ì‹œì—ë§Œ í•œ ë²ˆ ì°¾ê¸°
            if (_instance == null && !isInitialized)
            {
                _instance = FindFirstObjectByType<T>();
            }

            // ì—¬ì „íˆ nullì´ë©´ ê²½ê³ 
            if (_instance == null)
            {
                Debug.LogError($"[EagerMonoSingleton] {typeof(T).Name}ì´(ê°€) ì”¬ì— ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. " +
                               $"ì”¬ì— GameObjectë¥¼ ë°°ì¹˜í•˜ê³  {typeof(T).Name} ì»´í¬ë„ŒíŠ¸ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”.");
            }

            return _instance;
        }
    }

    /// <summary>
    /// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ì–´ ìˆê³  íŒŒê´´ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
    /// </summary>
    /// <returns>ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ê³  ì‚´ì•„ìˆìœ¼ë©´ true, ì•„ë‹ˆë©´ false</returns>
    public static bool IsAlive() => _instance != null && !isApplicationQuitting;

    /// <summary>
    /// DontDestroyOnLoad ì ìš© ì—¬ë¶€ (ê¸°ë³¸ê°’: true)
    /// íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ë³€ê²½ ê°€ëŠ¥
    /// </summary>
    protected virtual bool IsPersistent => true;

    protected virtual void Awake()
    {
        // ì´ë¯¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°
        if (_instance != null && _instance != this)
        {
            Debug.LogWarning($"[EagerMonoSingleton] {typeof(T).Name}ì´(ê°€) ì”¬ì— ì¤‘ë³µìœ¼ë¡œ ì¡´ì¬í•©ë‹ˆë‹¤. " +
                           $"ì¤‘ë³µ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤.");
            Destroy(gameObject);
            return;
        }

        _instance = this as T;
        isInitialized = true;

        // DontDestroyOnLoad ì„¤ì •
        if (IsPersistent)
        {
            DontDestroyOnLoad(gameObject);
        }

        // ì´ˆê¸°í™”
        Initialize();
    }

    /// <summary>
    /// ì´ˆê¸°í™” ë©”ì„œë“œ íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ë³€ê²½ ê°€ëŠ¥
    /// </summary>
    protected virtual void Initialize()
    {
    }


    protected virtual void OnApplicationQuit()
    {
        isApplicationQuitting = true;
    }

    protected virtual void OnDestroy()
    {
        // ìì‹ ì´ ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ì¸ ê²½ìš°ì—ë§Œ í•´ì œ
        if (_instance == this)
        {
            isApplicationQuitting = true;
            isInitialized = false;
        }
    }
}
```

###### MonoBehaviour Singleton - Lazy
```cs
public abstract class LazyMonoSingleton<T> : MonoBehaviour where T : MonoBehaviour
{
    private static T _instance;
    private static readonly object _lock = new object();
    private static bool isApplicationQuitting = false;

    public static T Instance
    {
        get
        {
            // ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì¤‘ì—ëŠ” null ë°˜í™˜ (ì›Œë‹ ë°©ì§€)
            if (isApplicationQuitting)
            {
                return null;
            }

            lock (_lock)
            {
                // ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ê°€ ì—†ìœ¼ë©´ ì”¬ì—ì„œ ì°¾ê¸°
                _instance ??= FindFirstObjectByType<T>();

                // ì”¬ì—ë„ ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
                if (_instance == null)
                {
                    GameObject singletonObject = new GameObject($"[Singleton] {typeof(T).Name}");
                    _instance = singletonObject.AddComponent<T>();
                }

                return _instance;
            }
        }
    }

    /// <summary>
    /// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ì–´ ìˆê³  íŒŒê´´ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
    /// </summary>
    /// <returns>ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ê³  ì‚´ì•„ìˆìœ¼ë©´ true, ì•„ë‹ˆë©´ false</returns>
    public static bool IsAlive() => _instance != null && !isApplicationQuitting;

    /// <summary>
    /// DontDestroyOnLoad ì ìš© ì—¬ë¶€ (ê¸°ë³¸ê°’: true)
    /// íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ë³€ê²½ ê°€ëŠ¥
    /// </summary>
    protected virtual bool IsPersistent => true;

    protected virtual void Awake()
    {
        // ì´ë¯¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°
        if (_instance != null && _instance != this)
        {
            // ì¤‘ë³µ ì¸ìŠ¤í„´ìŠ¤ ì œê±°
            Destroy(gameObject);
            return;
        }

        _instance = this as T;

        // DontDestroyOnLoad ì„¤ì •
        if (IsPersistent)
        {
            DontDestroyOnLoad(gameObject);
        }

        // ì´ˆê¸°í™”
        Initialize();
    }

    /// <summary>
    /// ì´ˆê¸°í™” ë©”ì„œë“œ íŒŒìƒ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ë³€ê²½ ê°€ëŠ¥
    /// </summary>
    protected virtual void Initialize()
    {
    }

    protected virtual void OnApplicationQuit()
    {
        isApplicationQuitting = true;
    }

    protected virtual void OnDestroy()
    {
        // ìì‹ ì´ ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ì¸ ê²½ìš°ì—ë§Œ í•´ì œ
        if (_instance == this)
        {
            isApplicationQuitting = true;
        }
    }
}
```


---

# ê²°ë¡ 
ì‚¬ì‹¤ ë³„ê±° ì—†ê¸´í•˜ë‹¤. ìš”ìƒŒ AIê°€ ì˜ ë§Œë“¤ì–´ì£¼ê¸°ë„ í•˜ê³ , ë§ì´ ë³´í¸í™” ë˜ì–´ìˆê¸°ë„ í•˜ê³ . ê·¸ë˜ë„ ì´ë ‡ê²Œ í•˜ë‚˜ì¯¤ì€ ê³„ì† ì“°ëŠ”ê±° ê°€ì§€ê³  ìˆì–´ì•¼ì§€ ì‹¶ì–´ì„œ ì •ë¦¬í•´ë´¤ë‹¤.
ëˆ„ê°€ë³¼ê¹Œ ì‹¶ì§€ë§Œ í˜¹ì‹œ í‹€ë¦° ë¶€ë¶„ì´ë‚˜ ë” ê°œì„ í•  ë¶€ë¶„ì´ ìˆë‹¤ë©´ ëŒ“ê¸€ë¡œ ì•Œë ¤ì£¼ì‹œê¸¸.
